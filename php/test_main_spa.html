<!DOCTYPE html>
<html>
<head>
    <title>Test Main SPA</title>
</head>
<body>
    <h1>Test Main SPA Page</h1>
    <p>This will test the actual spa.php page</p>
    
    <iframe src="spa.php" width="100%" height="600px" id="spa-frame"></iframe>
    
    <div id="results"></div>
    
    <script>
        console.log('Test page loaded');
        
        const iframe = document.getElementById('spa-frame');
        iframe.onload = function() {
            console.log('SPA iframe loaded');
            document.getElementById('results').innerHTML += '<p>✅ SPA iframe loaded</p>';
            
            try {
                // Try to access the SPA from the iframe
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                const spa = iframe.contentWindow.spa;
                
                if (spa) {
                    console.log('SPA found in iframe:', spa);
                    document.getElementById('results').innerHTML += '<p>✅ SPA found in iframe</p>';
                    
                    if (spa.searchProfiles) {
                        console.log('searchProfiles method found');
                        document.getElementById('results').innerHTML += '<p>✅ searchProfiles method found</p>';
                    } else {
                        console.error('searchProfiles method not found');
                        document.getElementById('results').innerHTML += '<p>❌ searchProfiles method not found</p>';
                    }
                } else {
                    console.error('SPA not found in iframe');
                    document.getElementById('results').innerHTML += '<p>❌ SPA not found in iframe</p>';
                }
            } catch (error) {
                console.error('Error accessing iframe:', error);
                document.getElementById('results').innerHTML += '<p>❌ Error accessing iframe: ' + error.message + '</p>';
            }
        };
        
        iframe.onerror = function() {
            console.error('Failed to load SPA iframe');
            document.getElementById('results').innerHTML += '<p>❌ Failed to load SPA iframe</p>';
        };
    </script>
</body>
</html>
